{"ast":null,"code":"import _objectSpread from\"/home/aurasonicSkyfire/github/levelUp/zz-poc/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/aurasonicSkyfire/github/levelUp/zz-poc/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useCallback,useEffect,useState}from\"react\";import{useDispatch}from\"react-redux\";import{useNavigate}from\"react-router-dom\";import styles from'./Overlay.module.css';import{attemptLogin}from\"./../loginModalSlice\";// ---- OVERLAY COMPONENT ----\n// local state collects form data and dispatches to redux-thunk\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var LoginOverlay=function LoginOverlay(){var initialState={user:'',password:''};var _useState=useState(initialState),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];var userHandler=function userHandler(e){setFormData(function(currentState){return _objectSpread(_objectSpread({},currentState),{},{user:e.target.value});});};var passwordHandler=function passwordHandler(e){setFormData(function(currentState){return _objectSpread(_objectSpread({},currentState),{},{password:e.target.value});});};var dispatch=useDispatch();var navigate=useNavigate();// ###=========== WORK ON AUTHENTICATION LOGIC =========###\n// dispatch to redux-thunk for authentication\n// -- if validated, redirect to dashboard page\n// -- on fail, render fail\nvar _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isValidUser=_useState4[0],setIsValidUser=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),didAuthFail=_useState6[0],setDidAuthFail=_useState6[1];console.log(isValidUser,didAuthFail);// ---- handle site entry for auth'd users and guests with no login\nvar validEntryHandler=useCallback(function(){return navigate('/dashboard');},[navigate]);var loginAttemptHandler=function loginAttemptHandler(e){e.preventDefault();// e.target.blur();\n// call async AttemptLogin\ndispatch(attemptLogin(formData));// -- handle promise onFulfillment ### currently mocking a valid authentication\nsetIsValidUser(function(current){return!current;});// <----- mock successful user auth\n};useEffect(function(){if(isValidUser){console.log('are we reaching this?',isValidUser);return validEntryHandler();}// else {\n//   // handle authentication failure  // mocks an auth fail\n//   setDidAuthFail(currentState => {\n//     setFormData(initialState);\n//     return !currentState;\n//   }); \n// }\n},[isValidUser,validEntryHandler]);return/*#__PURE__*/_jsx(\"div\",{className:styles.modal,children:/*#__PURE__*/_jsxs(\"form\",{className:styles['login-form'],onSubmit:loginAttemptHandler,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"user\",children:\"user\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"user\",id:\"user\",value:formData.user,required:true,onChange:userHandler}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"password\",id:\"password\",value:formData.password,required:true,onChange:passwordHandler}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",\"aria-label\":\"Submit login credentials\",children:\"login\"}),didAuthFail&&/*#__PURE__*/_jsx(\"div\",{className:styles.loginFail,children:\"login failed\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",\"aria-label\":\"Guest Entry\",onClick:validEntryHandler,children:\"guest pass\"})]})});};export default LoginOverlay;","map":{"version":3,"sources":["/home/aurasonicSkyfire/github/levelUp/zz-poc/client/src/routes/LoginPage/LoginModal/Overlay/Overlay.jsx"],"names":["React","useCallback","useEffect","useState","useDispatch","useNavigate","styles","attemptLogin","LoginOverlay","initialState","user","password","formData","setFormData","userHandler","e","currentState","target","value","passwordHandler","dispatch","navigate","isValidUser","setIsValidUser","didAuthFail","setDidAuthFail","console","log","validEntryHandler","loginAttemptHandler","preventDefault","current","modal","loginFail"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { useNavigate } from \"react-router-dom\";\n\nimport styles from './Overlay.module.css';\n\nimport { attemptLogin } from \"./../loginModalSlice\";\n\n\n// ---- OVERLAY COMPONENT ----\n// local state collects form data and dispatches to redux-thunk\nconst LoginOverlay = () => {\n  const initialState = {\n    user: '',\n    password: '',\n  }\n  \n  const [formData, setFormData] = useState(initialState);\n\n  const userHandler = e => {\n    setFormData(currentState => {\n      return {\n        ...currentState,\n        user: e.target.value,\n      }\n    })\n  }\n\n  const passwordHandler = e => {\n    setFormData(currentState => {\n      return {\n        ...currentState,\n        password: e.target.value,\n      }\n    })\n  }\n\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n  \n\n\n\n// ###=========== WORK ON AUTHENTICATION LOGIC =========###\n  // dispatch to redux-thunk for authentication\n  // -- if validated, redirect to dashboard page\n  // -- on fail, render fail\n  const [isValidUser, setIsValidUser] = useState(false);\n  const [didAuthFail, setDidAuthFail] = useState(false);\n  console.log(isValidUser, didAuthFail);\n\n  // ---- handle site entry for auth'd users and guests with no login\n  const validEntryHandler = useCallback(() => navigate('/dashboard'), [navigate]);\n\n  const loginAttemptHandler = e => {\n    e.preventDefault();\n    // e.target.blur();\n\n    // call async AttemptLogin\n    dispatch(attemptLogin(formData));\n    \n    // -- handle promise onFulfillment ### currently mocking a valid authentication\n    setIsValidUser(current => !current);  // <----- mock successful user auth\n  }\n  \n  useEffect( () => {\n    if (isValidUser) {\n      console.log('are we reaching this?', isValidUser)\n      return validEntryHandler();\n    } \n    // else {\n    //   // handle authentication failure  // mocks an auth fail\n    //   setDidAuthFail(currentState => {\n    //     setFormData(initialState);\n    //     return !currentState;\n    //   }); \n    // }\n  }, [isValidUser, validEntryHandler]);\n\n  return (\n    <div className={styles.modal} >\n      <form className={styles['login-form']} onSubmit={loginAttemptHandler} >\n                  \n        <label htmlFor=\"user\" >user</label>\n        <input type=\"text\" \n                name=\"user\" \n                id=\"user\" \n                value={formData.user}\n                required={true} \n                onChange={userHandler} >\n        </input>\n        \n        <label htmlFor=\"password\" >password</label>\n        <input type=\"text\" \n                name=\"password\" \n                id=\"password\" \n                value={formData.password}\n                required={true} \n                onChange={passwordHandler} >\n        </input>\n\n        <button type=\"submit\" aria-label=\"Submit login credentials\" >login</button>\n        {(didAuthFail) && <div className={styles.loginFail}>login failed</div>}\n\n        {/* temporary login bypass */}\n        <button type=\"button\" aria-label=\"Guest Entry\" onClick={validEntryHandler}>guest pass</button>\n      </form>\n    </div>\n  );\n};\n\nexport default LoginOverlay;"]},"metadata":{},"sourceType":"module"}